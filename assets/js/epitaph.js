epitaphs = [
	"A Delaware S-corporation",
	"Does not play well with others",
	"The fun will now commence",
	{ "before": "Neither new nor improved" },
	{ "after": "More thing for your thing", "aftertip": "AT&T marketing did not think this slogan through..." },
	"Guaranteed not to turn pink in the can",
	"An outside joke",
	"A fragile bloom",
	"Do not use if seal is broken",
	"A trackless mind",
	"A wonderful part of life&apos;s rich pageant",
	{ "after": "Handsome in an ugly sort of way", "aftertip": "Tom Lehrer is a genius" },
	"An action packed thrill ride",
	"Transmitido en Espanol en SAP",
	{ "after": "Beaten to death with his own slides", "aftertip": "The joys of teaching EECS150 to 100 eager students all fueled by hatred and caffeine."},
	"A Tour de Farce",
	"Don&apos;t look directly at him",
	"The last pasty white nerd",
	"Both sly and fly",
	{ "after": "I rock the cowgirl blues", "aftertip": "Motion City Soundtrack - The Future Freaks Me Out"},
	{ "after": "I rock the Haro Sport", "aftertip": "Motion City Soundtrack - The Future Freaks Me Out"},
	{ "after": "What <strong>is</strong> up with Will and Grace?", "aftertip": "Motion City Soundtrack - The Future Freaks Me Out"},
	{ "after": "The 32nd flavor of ice cream", "aftertip": "Eat your heart out Baskin Robbins" },
	"Addicted to dihydrogen monoxide",
	"Depriving students of sleep since &apos;03",
	"Master of squirrels",
	"Delicious with chocolate sprinkles",
	"You know you want a slice",
	"The TA formerly known as &quot;Amy&quot;",
	{ "after": "My duck appears to be crooked", "aftertip": "With apologies to Nicole B. wherever she's gone in the world" },
	"Silence of the clams",
	{ "after": "Llama Whippin&apos; Good", "aftertip": "Remember WinAMP? Anyone? No? I'm really that old, huh?" },
	"Fruity yet tangy",
	"You can&apos;t live without him",
	"Your night in a shining armoire",
	{ "before": "And now for something completely inappropriate" },
	"A toilet brush in his next life",
	"Proud monger of the world&apos;s supply of stupid",
	"A theater of cruelty",
	{ "after": "A regular guest star on blossom", "aftertip": "Less funny now that Mayim Bialik is on Big Bang Theory." },
	{ "after": "Synthesized from 100% natural Verilog", "aftertip": "Just kidding there's nothing natural about Verilog." },
	"Cute and fluffy",
	{ "after": "Neither a llama, nor a tuna", "aftertip": "With apologies to Nicole and Arlo wherever they are" },
	"Sexy in a tiara",
	{ "after": "Not a pygmy marmoset", "aftertip": "This may be the only true epitaph on here." },
	"The third Wondertwin",
	"Just a test of the emergency stupid system",
	{ "after": "Irresistable in a tangerine speedo", "aftertip": "Caviar - Tangerine Speedo" },
	{ "after": "Proud spokesman for Sporkle", "aftertip": "Nibbler? Leela? Futurama? Nothing? Okay, you people have to remember TV, right?" },
	"Enjoying insanity",
	"A pop diva",
	"Phoney like baloney",
	{ "after": "Just don&apos;t ask", "aftertip": "Seriously, we told you not to ask." },
	"Smooth as gravel",
	{ "after": "The other other white meat", "aftertip": "On the list of white meats, I might actually be 6 or 7 down, somewhere after squid." },
	"The almost cheese but not quite",
	"A special kind of stupid",
	"Herding pink elephants",
	"You know you want some",
	{ "after": "The t*** fairy", "aftertip": "With thanks to Nicole B." },
	"A beer swilling tube jockey",
	"Checkmate, suckers",
	"Cultured, like a petri dish",
	"15 minutes of shame",
	"The zit on your forehead",
	"Just a love machine",
	"A universal constant",
	"A witty rejoinder",
	"Winners don&apos;t wear rugs",
	{ "after": "Buggering hedgehogs since &apos;79", "aftertip": "c.f. Nanny Ogg in any Terry Pratchett book, and if you don't get the reference, I don't want to know you anymore. You used to be cool." },
	"A disco inferno",
	"A swift kick in the a**",
	"Deep fried to perfection",
	"Your blind date",
	"A two leaf clover",
	"Died the way he was born: naked and screaming",
	"Just a henchmen",
	"Your biggest fan",
	"Circling the drain",
	"Your sidekick",
	"Shave the whales",
	"Occam&apos;s shaving cream",
	"Invading your brain",
	{ "after": "Made from 100% Real Beef&trade;", "aftertip": "Am I the only one who gets a little worried when normal expressions have capitalization and trademarks? Is that just because of Sable's food company in Good Omens?" },
	"Sharp as a pillow",
	"A mouthful",
	"Gettin the party started",
	"An optional evil",
	"Delivered fresh daily",
	"Best hot dog in the known universe",
	"The rhythm already got him",
	"Serving steaming fresh pages",
	"&lt;INSERT HILARIOUS EPITAPH HERE&gt;",
	"Relax this will only hurt a little...",
	"An ethical conundrum",
	"Armageddon in a delicious 5&apos;11&quot; package",
	"Save the drama for yo mama",
	"Verilog ninja",
	{ "before": "Clive Barker Presents:" },
	{ "after": "A wascaly wabbit", "aftertip": "If you needed the title text to get this, I feel sorry for your childhood." },
	"The Lindbergh baby",
	"Amelia Earhart in disguise",
	"A cultural vacuum",
	{ "after": "Pretty fly for a white guy", "aftertip": "The Offspring - Pretty Fly (For a White Guy)" },
	"A &quot;special&quot; brownie",
	"More candy than a pinata",
	{ "before": "The artist formerly known as" },
	{ "after": "The Chaos Pope&apos;s idiot cousin", "aftertip": "Goats was a wonderful comic strip. I miss it." },
	"The world&apos;s favorite pie filling",
	"I find your lack of pants disturbing",
	{ "after": "The Beer Baron", "aftertip": "A rare spotting of a Simpsons reference in the wild. They're nearly extinct now!" },
	"A brief fling",
	"Wiggy wiggy what?",
	{ "after": "S-M-R-T, I Mean S-M-A-R-T", "aftertip": "A rare spotting of a Simpsons reference in the wild. They're nearly extinct now!" },
	"Inquire without",
	"Pepped up on goofballs",
	"Stiff as a plank",
	"Stuffed like a turkey",
	"A feature, not a bug",
	"A fluffy little bunny",
	"A bitter husk of a human being",
	"President, CEO, Revolutionary",
	"Too sexy for this site",
	"Booyah!",
	"Cuckoo for cocoa puffs",
	{ "after": "Both wet <strong>&amp;</strong> wild", "aftertip": "You're surprised, I know. You thought I was at MOST one or the other." },
	"The fourth stooge",
	{ "before": "For a good time call", "beforetip": "...someone else" },
	"The hole in your sole",
	"An altered reality",
	{ "after": "Do you have any grey poupon?", "aftertip": "AHAHAHAHAHAHAHA Such an old reference..." },
	"Your purpose in life",
	"A sordid affair",
	"Outsourced to Mexico",
	"A freaky pokemon",
	"Dangerously unqualified",
	"A shiny new donkey",
	{ "after": "No purchase necessary", "aftertip": "...or adviseable" },
	"You might already be a loser",
	"Trophy husband",
	"Crafted with olde worlde style",
	"With zesty ranch flavor",
	"Like a sweaty yeti",
	"A shady back room deal",
	{ "after": "Built like a yugo", "aftertip": "What do you call shock absorbers in a Yugo? Passengers!  AHAHAHAha haha ha... no." },
	{ "after": "A shocking teflon sea anemone", "aftertip": "I really don't know." },
	"A cry for help",
	"A golden chalice",
	"Tasty in lederhosen",
	"Nectar of the Gods",
	{ "after": "He put the bop in the bop-she-bop-she-bop", "aftertip": "Barry Mann - Who Put the Bomp" },
	"A fly on your wall",
	{ "after": "Waitress at the last chance saloon", "aftertip": "With apologies to both Rincewind and Terry Pratchett" },
	"Rocking the boat, baby",
	{ "after": "Rusted, sometimes brilliant busted", "aftertip": "Eve 6 - Promise" },
	{ "after": "A smile and a promise", "aftertip": "Eve 6 - Promise" },
	{ "after": "A particular kind of bastard", "aftertip": "White Collar Season1 Episode1" },
	"All smoke and mirrors",
	"Center of your universe",
	"A gaseous body",
	"A stellar body",
	"A heavenly body",
	"A bitter heart",
	"Stealing your dignity",
	"Rubbing your nose in it",
	"Weird Al&apos;s crazy twin",
	"Just plain spunky",
	"Friend of the uptrodden",
	"Scourge of all life",
	{ "after": "There are no dumb questions; There are a <strong>lot</strong> of inquisitive idiots", "aftertip": "despair.com" },
	"Made from 100% recycled evil",
	"Too hot to handle",
	"Sterile from monitor radiation",
	"Stabbing students with pencils since &apos;03",
	"Fueled by human misery",
	"Because it&apos;s a Tuesday",
	{ "after": "Now free of (fnord) subliminal messages", "aftertip": "I miss both Pinky and the Brain! Guess what I'm gonna do tonight?" },
	{ "after": "Your Sharona", "aftertip": "The Knack - My Sharona" },
	{ "after": "So many swears...", "aftertip": "There are more Simpsons quotes in here than you'd expect in 2018 when I wrote these" },
	"Folded, spindled and mutilated",
	"Dancing on his own grave",
	"Your backup singer",
	"Armed with Jell-O",
	"Dangerous, but only in the psychiatric sense",
	"The last honest pizza",
	{ "after": "A bustling marketplace of ideas", "aftertip": "I hear laughing in my head when I read this..." },
	"Wonder Woman (in disguise)",
	{ "after": "That&apos;s no woman! That&apos;s a man, baby!", "aftertip": "Austin Powers is so very very over." },
	"The voice of unreason",
	"An urban myth",
	"Inventor of kumquats",
	"Your free gift",
	{ "after": "A Man, A Can, A Plan", "aftertip": "World's silliest cookbook, I just had to steal the title." },
	"Accepted more places than visa",
	"A renaissance",
	{ "after": "Emptier than a scottish pay toilet", "aftertip": "I must have been watching Simpsons a lot when I wrote these years ago" },
	"Pop culture icon",
	{ "after": "Being lazy so you don&apos;t have to", "aftertip": "Somebody's got to do it!" },
	"The monster under your bed",
	"31 flavors of crazy",
	{ "after": "And IIIIIIIIII will always love yoooouuuu", "aftertip": "No I won't." },
	"Born free then caged",
	"A household name",
	"A little confused",
	{ "after": "Wait, I don&apos;t get it", "aftertip": "What you've said after reading each and every one of these." },
	"The bat in your belfry",
	"A festering boil on society",
	"Scaring you for life",
	"A natural source of emotional trauma",
	"The ants in your pants",
	"A marginally sinister plot",
	{ "after": "Floggin the oggin", "aftertip": "Terry Pratchett reference.  You should read more." },
	"A blow to your eggo",
	"An enchanted evening",
	"The nutcracker",
	"A six act musical",
	"Just like Mardi Gras",
	"Proud sponsor of the living room olympics",
	"Adrift in a sea of decadence",
	"A dainty morsel",
	{ "after": "A hamster with a hormone condition", "aftertip": "Get Fuzzy was a great comic strip." },
	"Stealer of souls, eater of fig newtons",
	"Pleasing none of the people all the time",
	"Got the <strong>bling</strong> <strong>bling</strong>",
	{ "after": "Stranger by the day", "aftertip": "Shades Apart - Stranger By The Day" },
	"A hip new look",
	"Lather, rinse, repeat",
	{ "after": "A rastafarian accountant", "aftertip": "Hermes Conrad. If that's not enough said, we're no longer friends." },
	"Tally me banana",
	{ "before": "Now auditioning for the part of:" },
	"Next to him perfection is crap",
	{ "after": "Jenius at work", "aftertip": "With the less common 'J' spelling" },
	"A media circus",
	"The man in the moon",
	"Your deepest desire",
	"Your darkest secret",
	"A wood chucking woodchuck",
	"Bigger then curly fries",
	"A penguin in your closet",
	{ "after": "The deadly spore, with the hilarious name", "aftertip": "Arachnospores. Futurama. Hey this is funny stuff people, don't blame me for your lack of culture. Be more like yogurt." },
	{ "after": "As seen on TV", "aftertip": "Actually this is now technically true!" },
	"A disfiguring disease",
	{ "after": "Now with 50% more issues", "aftertip": "I'll let you guess if they're Jira or psychological." },
	"A demented beanie baby",
	"A cubic zirconium in the rough",
	"The fifth teletubby",
	{ "after": "Go Stanfurd!", "aftertip": "No, but really Go Bears!" },
	"It&apos;ll make you go blind",
	"Drinking strawberry wine",
	"I took EECS150 and all i got was this lousy TA",
	{ "after": "The glue that holds together the gears of our society", "aftertip": "Think about it harder if you don't get it." },
	{ "after": "Like turpentine through a sick donkey", "aftertip": "Terry Pratchett again." },
	{ "after": "A demented libertarian zombie mutant", "aftertip": "Futurama was a great show!" },
	"The reason for childproof bottles",
	"Made from recycled bologna",
	{ "after": "Following the white rabbit", "aftertip": "The Matrix was good, but I deliberately avoided the sequels." },
	"Drained of bodily fluids",
	{ "after": "More orifices than carlsbad caverns", "aftertip": "Ew." },
	"Like a dirty Speak-n-Say",
	"The most annoying ring-tone",
	"A rampaging octopus",
	{ "after": "You should see him in a miniskirt", "aftertip": "No, you really shouldn't." },
	"A nonstop rollercoaster of stupid",
	{ "after": "The original staple bitch", "aftertip": "Shout out to Alex K. whatever he's up to these days, and the horrible things we tried to teach to innocent students!" },
	"Like, totally blonde",
	"Call him bubba",
	"A little slice of heaven",
	{ "after": "He sings like Ringo", "aftertip": "Because no one listens to Beatles for Octopus Garden." },
	"A mole person in disguise",
	"The UFO from roswell",
	"A crooked politician",
	{ "after": "Pinup model", "aftertip": "Actually technically true since I originally wrote it." },
	"A half baked idea",
	"Genetically modified for flavor",
	"Ex-host of YeeHaa",
	"Covered in peanut butter",
	"A cheeky 19th century boot black",
	"The crappiest place on earth",
	"Older, not wiser",
	"The last honest conspiracy nut",
	"Whole stole my pants?",
	"A tranqued out freak on stilts",
	{ "after": "World&apos;s second greatest lover", "aftertip": "Cassanunda the dwarf. Terry Pratchett people. Doesn't anyone read anymore?" },
	"The lightning round",
	"A sack of doorknobs",
	"Genie of the lamp",
	"Patent pending",
	"A magic elixir",
	"The next czar",
	"Your secret critic",
	"That special someone",
	"Celebrating bacon day every day",
	"Some assembly-code required",
	"Allow 4-6 weeks for delivery",
	"When in Rome",
	"The light&apos;s on but no one&apos;s home",
	"An experiment gone horribly wrong",
	"Partying like a rock star",
	"Part time faith healer",
	"Your valentine",
	"A temporary tattoo",
	"Married to the sea",
	"Greatest show on earth",
	"The winged toddler of love",
	"Elevating sarcasm to an art form",
	"Best before Jan 1, 2004",
	{ "after": "Necesito el bano", "aftertip": "Something Positive is just a special kind of insane." },
	"The wicked witch",
	"Impressively wrong",
	"Chimp pimp",
	{ "after": "Don&apos;t hate him for being beautiful", "aftertip": "There are so many better reasons, and he's not even beautiful, so this would make no sense." },
	"Everything you need",
	"A double entendre",
	"In need of repairs",
	"Living in sin",
	"The lizard queen",
	{ "after": "I am Jack&apos;s stupid quote", "aftertip": "Fight Club was a truly excellent movie. Ask me about the second time I watched it some day over a drink..." },
	{ "after": "Doing the Monster Mash", "aftertip": "Bobby Pickett - Monster Mash" },
	{ "after": "Bored of the rings", "aftertip": "With apologies to J.R.R. Tolkien." },
	{ "after": "Juicy like Starburst", "aftertip": "And a shout out to adorable Carly C. I'll forever remember her hopped up on sugar trying desperately to stay warm." },
	"Our little secret",
	"A big hairy deal",
	"A cure for sanity",
	"Your imaginary enemy",
	"The first butterfly of spring",
	"Powered by a magic hate ball",
	"Secret agent man",
	"Quirky and perky",
	"Oh, that&apos;s rich!",
	"A genuine thespian",
	"Wanted dead or alive",
	"A hunk of burning love",
	{ "after": "More bread than a prison meatloaf", "aftertip": "It's a quote from somewhere, but I'll be danged if I know where..." },
	"More powerful than a prison toilet",
	"A country bumpkin",
	"The new cheshire cat",
	"A made for TV movie",
	{ "after": "Available in double vision where drunk", "aftertip": "Futurama title texts are a gold mine of inspiration." },
	{ "after": "Don&apos;t lick him, or else", "aftertip": "Someone actually asked what the consequences were. That was better than the person who just took a risk. I needed a towel. And therapy." },
	"Prison snitch",
	"A mob don",
	"The curiously strong mint",
	{ "after": "Damn it feels good to be a gangster", "aftertip": "Geto Boys - Damn It Feels Good To Be A Gangsta, but in my head I see Office Space of course" },
	"Your mom&apos;s on fire",
	"Already sold out",
	"Wearing the pants in this relationship",
	"Your guidance counselor",
	"Dumber than two bags of bricks",
	"The bad cop",
	"Seizing your crown jewels",
	"Let&apos;s storm the bastille",
	"Your northern bounty",
	"It&apos;s not in my pants!",
	{ "before": "The Man! The Legend! Introducing:" },
	"A seventeenth century prophetess",
	"The smitten kitten",
	"Smitten by holy fire",
	"The littlest elder god",
	"A waste of a mind",
	"A windup toy",
	"A frozen corpsicle",
	{ "after": "Celebrating whacking day", "aftertip": "Simpsons reference! Everyone do a shot!" },
	"On a scale of 1 to 10, I&apos;m soooooooooo drunk",
	{ "after": "All work and no play makes Greg a dull boy", "aftertip": "Just kidding, he already was." },
	"The prophet of love",
	{ "before": "Don&apos;t squeeze the" },
	"Gargling butter",
	"I like pie",
	"Shut your pi-hole",
	"Did you bring your parental consent form?",
	{ "after": "Do you like pina coladas?", "aftertip": "Because I kinda can't stand them." },
	"Let&apos;s run away together",
	"Killing you softly",
	"Your booty call",
	"Off his meds",
	"New wave art",
	"Do you challenge me to a duel sir?",
	"A last resort",
	"Rhymes with &quot;tang&quot;",
	"A ladies man",
	"Delicious",
	"More addictive than crack",
	"A raw source of wacky hijinks",
	"Just an illusion",
	"Beaten like a naughty puppy",
	"Think fast!",
	"A drag king",
	"A red herring",
	"A chilling vision of things to come",
	"A blast from your past",
	"Nacho cheesier",
]
// { "after": 
// "aftertip": "" },

function loadEpitaph(getElement) {
	var seconds = 60 * 10; // Unless the user clicks, we'll show a new epitaph to them ever 10min, no matter how often they load the page
	var element = null;
	var marginTop = null, marginBottom = null;
	// Load or create (if forced or not present) a cookie which is keyed on
	// the "seconds" and "epitaphs.length" inputs. Return value is a random
	// number in the range [0,seconds*epitaphs.lenth). This will be used to
	// determine both an offset into the array, and which second of the time
	// block this browser should update epitaphs
	function loadCookie(force) {
		var prefix = "epitaph=";
		var product = epitaphs.length * seconds;

		if (!force) {
			var array = decodeURIComponent(document.cookie).split(';');
			for (var i = 0; i < array.length; i++) {
				var cookie = array[i];
				while (cookie.charAt(0) == ' ') cookie = cookie.substring(1);
				if (cookie.indexOf(prefix) == 0) {
					var components = cookie.substring(prefix.length, cookie.length).split('_');
					if ((components.length == 2) && (parseInt(components[0]) == product)) return parseInt(components[1]);
				}
			}
		}

		var value = Math.floor(Math.random() * product);
		document.cookie = prefix + product + "_" + value + ";path=/";
		return value;
	}
	// Remove any prior epitaph element. Add in the epitaph element using
	// innerHTML to allow formatting. Set the state flags.
	function epitaphBefore(epitaph, tip) {
		var created = document.createElement("div");
		created.innerHTML = epitaph;
		if (tip != null) created.title = tip;
		element.parentNode.insertBefore(created, element);
		marginTop = element.style.marginTop;
		element.style.marginTop = "0px";
	}
	function epitaphAfter(epitaph, tip) {
		var created = document.createElement("div");
		created.innerHTML = epitaph;
		if (tip != null) created.title = tip;
		element.parentNode.insertBefore(created, element.nextSibling);
		marginBottom = element.style.marginBottom;
		element.style.marginBottom = "0px";
	}
	// Use the cookie and current time (divide by seconds) to index into the
	// array.
	function setEpitaph(cookie) {
		if (element == null) return;

		if (marginTop != null) {
			element.style.marginTop = marginTop;
			element.parentNode.removeChild(element.previousSibling);
			marginTop = null;
		}
		if (marginBottom != null) {
			element.style.marginBottom = marginBottom;
			element.parentNode.removeChild(element.nextSibling);
			marginBottom = null;
		}

		var timeInSeconds = new Date().getTime() / 1000;
		var timeOffset = cookie % seconds;
		var timeIndex = Math.floor((timeInSeconds + timeOffset) / seconds);
		var cookieIndex = Math.floor(cookie / seconds);
		var index = (timeIndex + cookieIndex) % epitaphs.length;
		var epitaph = epitaphs[index];

		if (typeof epitaph === 'object') {
			if ('before' in epitaph) epitaphBefore(epitaph['before'], ('beforetip' in epitaph) ? epitaph['beforetip'] : null);
			if ('after' in epitaph) epitaphAfter(epitaph['after'], ('aftertip' in epitaph) ? epitaph['aftertip'] : null);
		} else if (typeof epitaph === 'string') epitaphAfter(epitaph);
	}
	function changeEpitaph() {
		setEpitaph(loadCookie(true));
	}
	function createEpitaph() {
		element = getElement();
		element.addEventListener("click", changeEpitaph, false);
		setEpitaph(loadCookie(false));
	}
	return createEpitaph;
}
